<a name=top></a><!doctype html>
<html lang=en-us>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<title>郝鸿涛：Hongtao Hao</title>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css>
<link rel=stylesheet href=/css/style.css>
<link rel=stylesheet href=/css/fonts.css>
<link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css rel=stylesheet>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/r.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/bash.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/python.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/vega@5.17.0></script>
<script src=https://cdn.jsdelivr.net/npm/vega-lite@4.17.0></script>
<script src=https://cdn.jsdelivr.net/npm/vega-embed@6.12.2></script>
<script>hljs.initHighlightingOnLoad()</script>
<link rel=icon href=https://hongtaoh.com/ht10.ico>
</head>
<body>
<div class=wrapper>
<header class=header>
<nav class=nav>
<a href=/ class=nav-logo>
<img src=/media/ht10.png width=50 height=50 alt="Hongtao Hao">
</a>
<ul class=nav-links>
<li><a href=/>Home</a></li>
<li><a href=/en/vitae/>Vitae</a></li>
<li><a href=/en/projects/>Projects</a></li>
<li><a href=/en/research/>Research</a></li>
<li><a href=/en/blog/>Blog</a></li>
<li><a href=/en/apad/>APAD</a></li>
<li><a href=/cn/blog/>中文</a></li>
</ul>
</nav>
</header>
<main class=content role=main>
<div style=text-align:center>
<h1>Julia: How to Conditionally Select Row(s) in A DataFrame</h1>
<p>Hongtao Hao
/ 2021-07-14 </p>
<hr>
</div>
<span class=article-toolbar>
<a href=https://github.com/hongtaoh/hongtaoh.github.io/edit/sources/content/en/blog/2021-07-14-julia-row-selection.md style=font-size:24px;color:#000 target=_blank><i class="fa fa-edit" aria-hidden=true title="Suggest an edit of this page"></i>
</a>
</span>
<div class="body-text list-text">
<p><div class=tip>
This post is tested under Julia v1.6.1 and DataFrames v1.2.0.
</div></p>
<p><a href=https://dataframes.juliadata.org/stable/lib/functions/#Base.filter target=_blank rel="noreferrer noopener"><code>Base.filter</code></a>
is suitable for this task.</p>
<pre tabindex=0><code>df = DataFrame(
    x = [3, 1, 2, 1, 5], 
    y = [&quot;b&quot;, &quot;c&quot;, &quot;a&quot;, &quot;b&quot;, &quot;b&quot;],
    z = [true, true, false, false, false]
)
</code></pre><div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>julia&gt; df
5×3 DataFrame
 Row │ x      y       z     
     │ Int64  String  Bool  
─────┼──────────────────────
   <span style=color:#666>1</span> │     <span style=color:#666>3</span>  b        <span style=color:green>true</span>
   <span style=color:#666>2</span> │     <span style=color:#666>1</span>  c        <span style=color:green>true</span>
   <span style=color:#666>3</span> │     <span style=color:#666>2</span>  a       <span style=color:green>false</span>
   <span style=color:#666>4</span> │     <span style=color:#666>1</span>  b       <span style=color:green>false</span>
   <span style=color:#666>5</span> │     <span style=color:#666>5</span>  b       <span style=color:green>false</span>
</code></pre></div><p>If it&rsquo;s just one condition, then selection is very simple:</p>
<div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>julia&gt; filter<span style=color:#666>(</span>r -&gt; r.x &gt; 1, df<span style=color:#666>)</span>
3×3 DataFrame
 Row │ x      y       z     
     │ Int64  String  Bool  
─────┼──────────────────────
   <span style=color:#666>1</span> │     <span style=color:#666>3</span>  b        <span style=color:green>true</span>
   <span style=color:#666>2</span> │     <span style=color:#666>2</span>  a       <span style=color:green>false</span>
   <span style=color:#666>3</span> │     <span style=color:#666>5</span>  b       <span style=color:green>false</span>
</code></pre></div><p><code>r</code> here stands for <code>row</code>, but you can replace it with anything you like: <code>t</code>, <code>row</code>, <code>anything</code>, etc.</p>
<p>If you have more than two conditions:</p>
<div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>julia&gt; filter<span style=color:#666>([</span>:x, :y<span style=color:#666>]</span> <span style=color:#666>=</span>&gt; <span style=color:#666>(</span>x, y<span style=color:#666>)</span> -&gt; x &gt; <span style=color:#666>1</span> <span style=color:#666>&amp;&amp;</span> <span style=color:#19177c>y</span> <span style=color:#666>==</span> <span style=color:#ba2121>&#34;b&#34;</span>, df<span style=color:#666>)</span>
2×3 DataFrame
 Row │ x      y       z     
     │ Int64  String  Bool  
─────┼──────────────────────
   <span style=color:#666>1</span> │     <span style=color:#666>3</span>  b        <span style=color:green>true</span>
   <span style=color:#666>2</span> │     <span style=color:#666>5</span>  b       <span style=color:green>false</span>
</code></pre></div><div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>julia&gt; filter<span style=color:#666>([</span>:x, :y, :z<span style=color:#666>]</span> <span style=color:#666>=</span>&gt; <span style=color:#666>(</span>x, y, z<span style=color:#666>)</span> -&gt; x &gt; <span style=color:#666>1</span> <span style=color:#666>&amp;&amp;</span> <span style=color:#19177c>y</span> <span style=color:#666>==</span> <span style=color:#ba2121>&#34;b&#34;</span> <span style=color:#666>&amp;&amp;</span> <span style=color:#19177c>z</span> <span style=color:#666>==</span> true, df<span style=color:#666>)</span>
1×3 DataFrame
 Row │ x      y       z    
     │ Int64  String  Bool 
─────┼─────────────────────
   <span style=color:#666>1</span> │     <span style=color:#666>3</span>  b       <span style=color:green>true</span>
</code></pre></div><p>You can do the same thing without using the <code>filter</code> function as well:</p>
<div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>julia&gt; df<span style=color:#666>[</span>df.x .&gt; 1, :<span style=color:#666>]</span>
3×3 DataFrame
 Row │ x      y       z     
     │ Int64  String  Bool  
─────┼──────────────────────
   <span style=color:#666>1</span> │     <span style=color:#666>3</span>  b        <span style=color:green>true</span>
   <span style=color:#666>2</span> │     <span style=color:#666>2</span>  a       <span style=color:green>false</span>
   <span style=color:#666>3</span> │     <span style=color:#666>5</span>  b       <span style=color:green>false</span>
</code></pre></div><div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>julia&gt; df<span style=color:#666>[(</span>df.x .&gt; 1<span style=color:#666>)</span> .&amp; <span style=color:#666>(</span>df.y .<span style=color:#666>==</span> <span style=color:#ba2121>&#34;b&#34;</span><span style=color:#666>)</span> .&amp; <span style=color:#666>(</span>df.z .<span style=color:#666>==</span> <span style=color:green>true</span><span style=color:#666>)</span>, :<span style=color:#666>]</span>
1×3 DataFrame
 Row │ x      y       z    
     │ Int64  String  Bool 
─────┼─────────────────────
   <span style=color:#666>1</span> │     <span style=color:#666>3</span>  b       <span style=color:green>true</span>
</code></pre></div><p><div class=tip>
Note that when you use the <code>Base.filter</code> function, you need to use <code>&&</code>, a <a href=https://docs.julialang.org/en/v1/manual/mathematical-operations/#Boolean-Operators target=_blank rel="noreferrer noopener">Boolean operator</a>
, whereas when you select rows using data frame indexing, you are supposed to use <code>&</code> (note the <a href=/en/2021/07/10/julia-dot/>Dot</a>
before it, though), a <a href=https://docs.julialang.org/en/v1/manual/mathematical-operations/#Bitwise-Operators target=_blank rel="noreferrer noopener">bitwise operator</a>
.
</div></p>
<h2 id=when-there-are-missing-values>When there are missing values<a href=#when-there-are-missing-values class=header-anchor arialabel=Anchor> # </a></h2>
<p>One thing you need to keep in mind is that if there are missing values in the data frame, you might not be able to use the second option, and you might not use <a href=https://docs.julialang.org/en/v1/manual/missing/#Equality-and-Comparison-Operators target=_blank rel="noreferrer noopener">equality and comparison operators</a>
in <code>filter</code>.</p>
<p>For example,</p>
<div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>julia&gt; <span style=color:#19177c>df</span> <span style=color:#666>=</span> DataFrame<span style=color:#666>(</span>
    <span style=color:#19177c>x</span> <span style=color:#666>=</span> <span style=color:#666>[</span>3, 1, 2, 1, missing<span style=color:#666>]</span>, 
    <span style=color:#19177c>y</span> <span style=color:#666>=</span> <span style=color:#666>[</span><span style=color:#ba2121>&#34;b&#34;</span>, <span style=color:#ba2121>&#34;c&#34;</span>, <span style=color:#ba2121>&#34;a&#34;</span>, <span style=color:#ba2121>&#34;b&#34;</span>, <span style=color:#ba2121>&#34;b&#34;</span><span style=color:#666>]</span>, 
    <span style=color:#19177c>z</span> <span style=color:#666>=</span> <span style=color:#666>[</span>true, true, false, false, false<span style=color:#666>]</span>
<span style=color:#666>)</span>
5×3 DataFrame
 Row │ x        y       z     
     │ Int64?   String  Bool  
─────┼────────────────────────
   <span style=color:#666>1</span> │       <span style=color:#666>3</span>  b        <span style=color:green>true</span>
   <span style=color:#666>2</span> │       <span style=color:#666>1</span>  c        <span style=color:green>true</span>
   <span style=color:#666>3</span> │       <span style=color:#666>2</span>  a       <span style=color:green>false</span>
   <span style=color:#666>4</span> │       <span style=color:#666>1</span>  b       <span style=color:green>false</span>
   <span style=color:#666>5</span> │ missing  b       <span style=color:green>false</span>

julia&gt; filter<span style=color:#666>(</span>r -&gt; r.x <span style=color:#666>==</span> 1, df<span style=color:#666>)</span>
ERROR: TypeError: non-boolean <span style=color:#666>(</span>Missing<span style=color:#666>)</span> used in boolean context

julia&gt; df<span style=color:#666>[</span>df.x .&gt; 1, :<span style=color:#666>]</span>
ERROR: ArgumentError: unable to check bounds <span style=color:green;font-weight:700>for</span> indices of <span style=color:green>type</span> Missing
</code></pre></div><p>You need to use <a href=https://docs.julialang.org/en/v1/base/base/#Base.isequal target=_blank rel="noreferrer noopener"><code>Base.isequal</code></a>
and <a href=https://docs.julialang.org/en/v1/base/base/#Base.isless target=_blank rel="noreferrer noopener"><code>Base.isless</code></a>
instead:</p>
<div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>julia&gt; filter<span style=color:#666>(</span>r -&gt; isequal<span style=color:#666>(</span>r.x, 1<span style=color:#666>)</span>, df<span style=color:#666>)</span>
2×3 DataFrame
 Row │ x       y       z     
     │ Int64?  String  Bool  
─────┼───────────────────────
   <span style=color:#666>1</span> │      <span style=color:#666>1</span>  c        <span style=color:green>true</span>
   <span style=color:#666>2</span> │      <span style=color:#666>1</span>  b       <span style=color:green>false</span>

julia&gt; df<span style=color:#666>[</span>isless.<span style=color:#666>(</span>1, df.x<span style=color:#666>)</span>, :<span style=color:#666>]</span>
3×3 DataFrame
 Row │ x        y       z     
     │ Int64?   String  Bool  
─────┼────────────────────────
   <span style=color:#666>1</span> │       <span style=color:#666>3</span>  b        <span style=color:green>true</span>
   <span style=color:#666>2</span> │       <span style=color:#666>2</span>  a       <span style=color:green>false</span>
   <span style=color:#666>3</span> │ missing  b       <span style=color:green>false</span>
</code></pre></div><p>Note that <a href=https://docs.julialang.org/en/v1/manual/missing/#Equality-and-Comparison-Operators target=_blank rel="noreferrer noopener">Julia Documentation mentions</a>
that in <code>isless</code> operator,</p>
<blockquote>
<p><code>missing</code> is considered as greater than any other value.</p>
</blockquote>
<p>This is the reason why you see the row containing <code>missing</code> in the result of <code>df[isless.(1, df.x), :]</code>.</p>
<h2 id=references>References<a href=#references class=header-anchor arialabel=Anchor> # </a></h2>
<ul>
<li><a href=https://discourse.julialang.org/t/dataframe-how-to-change-value-of-a-cell-without-knowing-the-row-number/22024 target=_blank rel="noreferrer noopener">DataFrame: how to change value of a cell without knowing the row number</a>
</li>
</ul>
<p style=color:#777>Last modified on 2022-09-30</p>
</div>
<a href=#top><i class="fa fa-chevron-up" style=font-size:30px;color:#000></i></a>
</main>
<footer class=footer>
<script src=https://utteranc.es/client.js repo=hongtaoh/hongtaoh.github.io issue-term=pathname theme=github-light crossorigin=anonymous async></script>
<script type=text/javascript src=/js/math-code.js></script>
<script async src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script type=text/javascript src=/js/center-img.js></script>
<ul class=footer-links>
<li><a href=/en/blog/index.xml type=application/rss+xml title="RSS feed">
Subscribe </a>
</li>
<li>
<a href=http://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank>
License
<i class="fa fa-cc" aria-hidden=true title="Attribution-NonCommercial-ShareAlike 4.0 International"></i>
</a>
</li>
</ul>
<div class=copyright-text>
©
Hongtao Hao
2020-2022
</div>
</footer>